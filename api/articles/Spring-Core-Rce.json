{"title":"Spring-Core-Rce 0day 通告","uid":"5be2d45f1267b8ebe5bb9dc94fd9c754","slug":"Spring-Core-Rce","date":"2022-03-30T13:51:40.000Z","updated":"2022-03-30T16:36:30.758Z","comments":true,"path":"api/articles/Spring-Core-Rce.json","keywords":null,"cover":"https://w.wallhaven.cc/full/o3/wallhaven-o3elvp.jpg","content":"<h3 id=\"漏洞时间线：\"><a href=\"#漏洞时间线：\" class=\"headerlink\" title=\"漏洞时间线：\"></a>漏洞时间线：</h3><p>2022-03-29：晚上业内师傅们开始公布漏洞利用成功，并未公布漏洞细节，github出现钓鱼（0day,红线标注，微步沙箱并未检测出威胁，经分析是钓鱼exe。），截至目前，仓库已经删除。</p>\n<p><img src=\"https://shenlin-1255940024.cos.ap-beijing.myqcloud.com/blog/Untitled.png\" alt=\"Untitled\"></p>\n<p>2022-03-30：漏洞影响开始发酵，开始出现部分exp代码。</p>\n<p><img src=\"https://shenlin-1255940024.cos.ap-beijing.myqcloud.com/blog/Untitled%201.png\" alt=\"Untitled\"></p>\n<h3 id=\"漏洞影响：\"><a href=\"#漏洞影响：\" class=\"headerlink\" title=\"漏洞影响：\"></a>漏洞影响：</h3><p>使用了Spring框架，jdk≥9.0，会造成影响，由于刚受到log4j2的影响，很多企业业务都升级到了jdk 9 以上，现在又出现新的漏洞实在是哭笑不得：</p>\n<p><img src=\"https://shenlin-1255940024.cos.ap-beijing.myqcloud.com/blog/Untitled%202.png\" alt=\"Untitled\"></p>\n<h3 id=\"临时修复建议：\"><a href=\"#临时修复建议：\" class=\"headerlink\" title=\"临时修复建议：\"></a>临时修复建议：</h3><p>1、应用中全局搜索@InitBinder注解，看看方法体内是否调用dataBinder.setDisallowedFields方法，如果发现此代码片段的引入，则在原来的黑名单中，添加**{“class.<em>“,”Class.</em>“,”<em>.class.</em>“, “<em>.Class.</em>“}，**在应用系统的项目包下新建以下全局类，并保证这个类被Spring加载到(推荐在Controller所在的包中添加)完成类添加后，需对项目进行重新编译打包和功能验证测试。</p>\n<p>2、在WAF等网络防护设备上，根据实际部署业务的流量情况，实现对“class.”“Class.”“.class.”“.Class.”等字符串的规则过滤，并在部署过滤规则后，对业务运行情况进行测试，避免产生影响。</p>\n<h3 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h3><p><a href=\"https://github.com/IanSmith123/spring-core-rce\">https://github.com/IanSmith123/spring-core-rce</a></p>\n<p><a href=\"https://www.cyberkendra.com/2022/03/springshell-rce-0-day-vulnerability.html\">https://www.cyberkendra.com/2022/03/springshell-rce-0-day-vulnerability.html</a></p>\n","feature":true,"text":"漏洞时间线：2022-03-29：晚上业内师傅们开始公布漏洞利用成功，并未公布漏洞细节，github出现钓鱼（0day,红线标注，微步沙箱并未检测出威胁，经分析是钓鱼exe。），截至目前，仓库已经删除。 2022-03-30：漏洞影响开始发酵，开始出现部分exp代码。 漏洞影响：...","link":"","photos":[],"count_time":{"symbolsCount":681,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"威胁通告","slug":"威胁通告","count":1,"path":"api/tags/威胁通告.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E6%97%B6%E9%97%B4%E7%BA%BF%EF%BC%9A\"><span class=\"toc-text\">漏洞时间线：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D%EF%BC%9A\"><span class=\"toc-text\">漏洞影响：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%B4%E6%97%B6%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A\"><span class=\"toc-text\">临时修复建议：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li></ol>","author":{"name":"神林","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一名面向github挖洞的安全研究员","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Redis-Escape-Rce","uid":"4851b902ea2223fecb14c4248effd820","slug":"redis-sand-box-rce","date":"2022-03-31T17:08:49.000Z","updated":"2022-03-31T17:19:10.454Z","comments":true,"path":"api/articles/redis-sand-box-rce.json","keywords":null,"cover":"https://w.wallhaven.cc/full/g7/wallhaven-g7mqkl.jpg","text":"[CVE-2022-0543] Redis-Lua-Sandbox-Escape-and-Remote-Code-Execution （redis 沙箱逃逸和远程代码执行——0x00:漏洞影响版本Ubuntu的Redis-Server 发行版本 状态 bionic 该版本不存在漏...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"漏洞分析","slug":"漏洞分析","count":1,"path":"api/tags/漏洞分析.json"}],"author":{"name":"神林","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一名面向github挖洞的安全研究员","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"php 代码审计","uid":"7e3aab8248542e317877e2ea637498f0","slug":"php-代码审计","date":"2022-03-27T15:39:39.000Z","updated":"2022-03-29T13:21:08.863Z","comments":true,"path":"api/articles/php-代码审计.json","keywords":null,"cover":"https://w.wallhaven.cc/full/j3/wallhaven-j3dg1m.jpg","text":" 详述php代码审计这件事常见cms框架： thinkphp yii 2.0 laravel php代码审计： 1、cms的代码审计 2、ctf题目中实战利用 3、针对一些开源代码审计 手段： 1、代码审计工具 2、代码审计点 3、特殊函数以及魔法函数 利用： 1、xss点 2、...","link":"","photos":[],"count_time":{"symbolsCount":497,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"代码审计","slug":"代码审计","count":1,"path":"api/tags/代码审计.json"}],"author":{"name":"神林","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一名面向github挖洞的安全研究员","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}